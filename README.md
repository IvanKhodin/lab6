# Лабораторная работа № 6

Выполнил Ходин Иван, 427 группа

## Вариант № 9

Задание: Найти точку минимума функции f(x1, x2, x3) =x21+ 8x1+ 5x22+ 7x23+ 119.0x3+ 531.75,[x1= 8, x2=−2, x3= 6].
*** методом наискорейшего спуска. Для одномерной минимизации использовать метод квадратичной интерполяции. Для поиска интервала унимолдальности использовать алгоритм скользящего окна.
В окрестности точки минимума построить линии уровня и траекторию поиска на одном графике.  

## Теоретическая часть
Для выполнения работы необходима теоретическая база и понимание работы перечисленных в задании методов:

Градиент функции в точке-вектор, координаты которого-это частные производные по соответствующим аргументам(их значения в данной точке).
<img src="/formul/5df3aa1a3bbbe0a459b3934dd992fb99.svg?invert_in_darkmode&sanitize=true" align=middle width=181.02647804999998pt height=37.48585995pt/>
Процессы приближенного решения задачи можно представить в виде (итерационные)
<img src="/formul/000f70ab12267b8e12a0b7011d0f438e.svg?invert_in_darkmode&sanitize=true" align=middle width=127.97846655pt height=20.60273655pt/>, 

где <img src="/formul/c81f39379f41391225416f647afe2e74.svg?invert_in_darkmode&sanitize=true" align=middle width=15.536596349999991pt height=34.81276919999997pt/> - вектор, который определяет направление движения от точки <img src="/formul/76faa63513161cc1ab7da6cadab2dd28.svg?invert_in_darkmode&sanitize=true" align=middle width=16.88074244999999pt height=27.91243950000002pt/> к точке <img src="/formul/63b7e6bc08ae6694a571beebbffead7f.svg?invert_in_darkmode&sanitize=true" align=middle width=33.524663699999984pt height=27.91243950000002pt/>, а <img src="/formul/3cc1484752cc8ef69d55b6991e28be35.svg?invert_in_darkmode&sanitize=true" align=middle width=17.78167709999999pt height=14.15524440000002pt/> - число, задающее размер шага в направлении <img src="/formul/c81f39379f41391225416f647afe2e74.svg?invert_in_darkmode&sanitize=true" align=middle width=15.536596349999991pt height=34.81276919999997pt/>.
Чтобы найти <img src="/formul/3cc1484752cc8ef69d55b6991e28be35.svg?invert_in_darkmode&sanitize=true" align=middle width=17.78167709999999pt height=14.15524440000002pt/>,используем метод квадратичной интерполяции и скользящего окна.




Алгоритм скользящего окна - нахождение интервалов a и b,где находиться минимум для ***.
Задаем ***, шаг ***
***
***
***




Метод квадратичной интерполяции:

1)Получение начальной точки из интервала a и b ***

2)***

3)***

4)Вычисление всех значений по трем точкам ***

5)***

6)Вычисление точки минимума полинома по трем точкам:
***
И вычисление велечины ***

При знаменателе ***   *** и возвращаемся на второй шаг

7)Проверка выполнения условия окончания: 
***

а)оба условия выполнены, значит ***

б)хотя бы одно из условий не выполнено, тогда и ***, выбрать точку *** и две точки по обе стороны от нее.Обозначить эти точки и перейти к пятому шагу алгоритма

в)если хотя бы одно из условий не выполнено, то и ***, тогда *** и перейти ко второму шагу


/*

Метод сопряженних градиентов- поиск экстремума функции по информации о её значениях и её градиенте.

Начальные приближения и погрешность <img src="/formul/71e56479f0744a1e3991eb7e67a219f5.svg?invert_in_darkmode&sanitize=true" align=middle width=15.94753544999999pt height=26.76175259999998pt/> и <img src="/formul/7ccca27b5ccc533a2dd72dc6fa28ed84.svg?invert_in_darkmode&sanitize=true" align=middle width=6.672392099999992pt height=14.15524440000002pt/>. Шаг находим из квадратичной интерполяции <img src="/formul/4a138d5b9122dc08c5251f5fbca64f19.svg?invert_in_darkmode&sanitize=true" align=middle width=234.89295059999995pt height=27.91243950000002pt/> при <img src="/formul/0c837ccdd0ecd0a1381239002bf821a4.svg?invert_in_darkmode&sanitize=true" align=middle width=40.713337499999994pt height=21.18721440000001pt/> 

Первоначальное направление <img src="/formul/345bc9b1c1343b593c19ad5a47c2ba63.svg?invert_in_darkmode&sanitize=true" align=middle width=104.24097419999998pt height=26.76175259999998pt/> из которого <img src="/formul/894e00d0f52952f444e2711bc403c03d.svg?invert_in_darkmode&sanitize=true" align=middle width=108.26093684999998pt height=26.76175259999998pt/>

<img src="/formul/a60dbd6e27b9bc1837f36c96e70d3c46.svg?invert_in_darkmode&sanitize=true" align=middle width=176.44237379999998pt height=27.91243950000002pt/> ,где <img src="/formul/74e3dfa6473a2753dcad8759808d2222.svg?invert_in_darkmode&sanitize=true" align=middle width=123.15832155pt height=37.282175700000025pt/> 

Заканчиваем при <img src="/formul/58915f74126b9cc2c5a0545749437ab1.svg?invert_in_darkmode&sanitize=true" align=middle width=154.81171364999997pt height=27.91243950000002pt/>

*/

Отредактировать ...

## Практическая часть
Программа содержит ряд ключевых функций, реализующих работу основных методов:
Функция fun(double *x) возвращает значение исходной функции в точке x (/*В действительности использовал возврат значения функции с противоположным знаком,так как первоначально невнимательно прочел задание и реализовывал поиск минимума, а не максимума. Это преобразование в силу свойств симметрии позволило адаптировать уже написанные методы, не изменяя их, так как координаты экстремума при этом сохраняются,а его значение принимает противоположный характер и знак по свойствам преобразований функций*/)  , prx1(double *x) и prx2(double *x) - производные по первой и второй переменной соответственно, funcn(double *x, double a, double p) - значение в точке x+ap. Метод скользящего окна wind(double *x, double a, double *p) возвращает середину отрезка унимодальности, метод квадратичной интерполяции inter(double *x, double a, double *p) возвращает точку максимума функции, метод сопряженных градиентов sopgrad(double *x0) выводит точку максимума функции и значение функции в этой точке, а также записывает в текстовый файл точки траектории поиска. Последовательность запуска: компиляция части программы на с++, ее запуск, затем запускаем часть на python, в которой находится отрисованная траектория поиска и линии уровня (также продублировал в нее всю часть программы на языке c++ в качестве дополнительного задания).  

### Результаты
У функции *** была найдена точка максимума [9.75, 1.25] (при начальной точке [-10, 0]) за две итерации с точностью 1е-6.(Экстремум, найденный программой, согласуется с его непосредственными вычислениями.) Рисунок с положением линий уровня и траектория поиска максимума:
![formul/img.png](formul/img.png)
