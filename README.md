# Лабораторная работа № 6

Выполнил Ходин Иван, 427 группа

## Вариант № 9

Задание: Найти точку минимума функции <img src="https://bit.ly/3eQMkmJ" align="center" border="0" alt="f( x_{1} , x_{2} , x_{3} ) =  x^{2}_{1}  + 8x_{1} + 5x^{2}_{2}  + 7x^{2}_{3}  + 119x_{3} + 531.75,    [ x_{1} = 8,  x_{2} = -2,  x_{3}  = 6]" width="660" height="26" /> методом наискорейшего спуска. Для одномерной минимизации использовать метод квадратичной интерполяции. Для поиска интервала унимолдальности использовать алгоритм скользящего окна.
В окрестности точки минимума построить линии уровня и траекторию поиска на одном графике.  

## Теоретическая часть

Для успешного выполнения работы необходима теоретическая база и понимание работы перечисленных в задании методов:

Метод наискорейшего спуска. В этом методе αk выбирается из условия минимума функции f(x) вдоль направления <img src="https://bit.ly/2KGLN98" align="center" border="0" alt=" p^{k} " width="24" height="24" />, т.е. <img src="https://bit.ly/2VGPBgC" align="center" border="0" alt="f( x^{k}  +  \alpha_{k}p^{k}) =  \min_{ \alpha > 0}  f( x^{k}  +  \alpha_{k}p^{k})    " width="264" height="24" />. Таким образом, в методе наискорейшего спуска на каждом шаге
необходимо решать задачу минимизации функции одной переменной.

Алгоритм скользящего окна - нахождение интервалов a и b,где находиться минимум для <img src="https://bit.ly/2W1pBfa" align="center" border="0" alt=" \alpha_{k} " width="24" height="15" />.

Выбираем <img src="https://bit.ly/2W4zys3" align="center" border="0" alt=" x^{0} " width="22" height="18" /> и задаем шаг h>0
<img src="https://bit.ly/3bJT97C" align="center" border="0" alt="1) f(x^{0} - h) > f(x^{0}) < f(x^{0} + h)  \Longrightarrow a = x^{0} - h, b = x^{0} + h " width="467" height="22" />
<img src="https://bit.ly/3bHmLCs" align="center" border="0" alt="2) f(x^{0} - h) >  f(x^{0} + h)  \Longrightarrow   x^{0} = x^{0} + h/2" width="336" height="22" />
<img src="https://bit.ly/2xiNE0M" align="center" border="0" alt="3) f(x^{0} - h) <  f(x^{0} + h)  \Longrightarrow   x^{0} = x^{0} - h/2" width="336" height="22" />




Метод квадратичной интерполяции:

1)Получение начальной точки из интервала a и b ***

2)***

3)***

4)Вычисление всех значений по трем точкам ***

5)***

6)Вычисление точки минимума полинома по трем точкам:
***
И вычисление велечины ***

При знаменателе ***   *** и возвращаемся на второй шаг

7)Проверка выполнения условия окончания: 
***

а)оба условия выполнены, значит ***

б)хотя бы одно из условий не выполнено, тогда и ***, выбрать точку *** и две точки по обе стороны от нее.Обозначить эти точки и перейти к пятому шагу алгоритма

в)если хотя бы одно из условий не выполнено, то и ***, тогда *** и перейти ко второму шагу


/*

Метод сопряженних градиентов- поиск экстремума функции по информации о её значениях и её градиенте.

Начальные приближения и погрешность <img src="/formul/71e56479f0744a1e3991eb7e67a219f5.svg?invert_in_darkmode&sanitize=true" align=middle width=15.94753544999999pt height=26.76175259999998pt/> и <img src="/formul/7ccca27b5ccc533a2dd72dc6fa28ed84.svg?invert_in_darkmode&sanitize=true" align=middle width=6.672392099999992pt height=14.15524440000002pt/>. Шаг находим из квадратичной интерполяции <img src="/formul/4a138d5b9122dc08c5251f5fbca64f19.svg?invert_in_darkmode&sanitize=true" align=middle width=234.89295059999995pt height=27.91243950000002pt/> при <img src="/formul/0c837ccdd0ecd0a1381239002bf821a4.svg?invert_in_darkmode&sanitize=true" align=middle width=40.713337499999994pt height=21.18721440000001pt/> 

Первоначальное направление <img src="/formul/345bc9b1c1343b593c19ad5a47c2ba63.svg?invert_in_darkmode&sanitize=true" align=middle width=104.24097419999998pt height=26.76175259999998pt/> из которого <img src="/formul/894e00d0f52952f444e2711bc403c03d.svg?invert_in_darkmode&sanitize=true" align=middle width=108.26093684999998pt height=26.76175259999998pt/>

<img src="/formul/a60dbd6e27b9bc1837f36c96e70d3c46.svg?invert_in_darkmode&sanitize=true" align=middle width=176.44237379999998pt height=27.91243950000002pt/> ,где <img src="/formul/74e3dfa6473a2753dcad8759808d2222.svg?invert_in_darkmode&sanitize=true" align=middle width=123.15832155pt height=37.282175700000025pt/> 

Заканчиваем при <img src="/formul/58915f74126b9cc2c5a0545749437ab1.svg?invert_in_darkmode&sanitize=true" align=middle width=154.81171364999997pt height=27.91243950000002pt/>

*/

Отредактировать ...

## Практическая часть
Программа содержит ряд ключевых функций, реализующих работу основных методов:
Функция fun(double *x) возвращает значение исходной функции в точке x (/*В действительности использовал возврат значения функции с противоположным знаком,так как первоначально невнимательно прочел задание и реализовывал поиск минимума, а не максимума. Это преобразование в силу свойств симметрии позволило адаптировать уже написанные методы, не изменяя их, так как координаты экстремума при этом сохраняются,а его значение принимает противоположный характер и знак по свойствам преобразований функций*/)  , prx1(double *x) и prx2(double *x) - производные по первой и второй переменной соответственно, funcn(double *x, double a, double p) - значение в точке x+ap. Метод скользящего окна wind(double *x, double a, double *p) возвращает середину отрезка унимодальности, метод квадратичной интерполяции inter(double *x, double a, double *p) возвращает точку максимума функции, метод сопряженных градиентов sopgrad(double *x0) выводит точку максимума функции и значение функции в этой точке, а также записывает в текстовый файл точки траектории поиска. Последовательность запуска: компиляция части программы на с++, ее запуск, затем запускаем часть на python, в которой находится отрисованная траектория поиска и линии уровня (также продублировал в нее всю часть программы на языке c++ в качестве дополнительного задания).  

### Результаты
У функции *** была найдена точка максимума [9.75, 1.25] (при начальной точке [-10, 0]) за две итерации с точностью 1е-6.(Экстремум, найденный программой, согласуется с его непосредственными вычислениями.) Рисунок с положением линий уровня и траектория поиска максимума:
![formul/img.png](formul/img.png)
